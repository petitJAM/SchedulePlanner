<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>itsvismay</title>
	<!-- styles stuff -->
	<link href="stylesheet-itsvismay.css" rel="stylesheet"></link>
	<!-- knockout stuff -->
	<script type="text/javascript" src="components/knockout-2.2.0.debug.js"></script>
	<script type='text/javascript' src="http://knockoutjs.com/examples/resources/knockout.simpleGrid.1.3.js"></script>
	<!-- jquery stuff -->
	<link href="components/jquery-ui-1.9.1.custom/css/start/jquery-ui-1.9.1.custom.css" rel="stylesheet">
	<script src="components/jquery-ui-1.9.1.custom/js/jquery-1.8.2.js"></script>
	<script src="components/jquery-ui-1.9.1.custom/js/jquery-ui-1.9.1.custom.js"></script>




</head>

<body>

	<form action='/someServerSideHandler'>
		<p>I have <span data-bind='text: categories().length'>&nbsp;</span> categories of things.</p>
		<table data-bind='visible: categories().length >= 0'>
			<thead>
				<tr>
					<th>Category name</th>
					<th>Difficulty</th>
					<th />
				</tr>
			</thead>
			<tbody data-bind='foreach: categories'>
				<tr>
					<td><input class='required' data-bind='value:ctgName, uniqueName: true' /></td>
					<td><select data-bind="options: $root.difficultyValues, value: ctgDifficulty, optionsText: 'diffName' "></select></td>
					<td><a href='#' data-bind='click: $root.removeCategory'>Delete</a></td>
				</tr>
			</tbody>
		</table>
		<button data-bind='click: addCategory'>Add Category</button>
		<button data-bind='enable: categories().length > 0' type='submit'>Submit</button>
	</form>

	<br><br><br><br>

	<form>
		<p>I have <span data-bind="text:todoList().length">&nbsp;</span> thing(s) to do.</p>
		<table data-bind="visible: todoList.length >=0">
			<thead>
				<tr>
					<th>Items Todo</th>
					<th>Category</th>
					<th>Date</th>
				</tr>
			</thead>
			<tbody data-bind="foreach:{data:todoList, as: 'todoItem'}">
				<tr>
					<td><input class="required" data-bind="value:todoItem.todoName, uniqueName:false"/></td>
					<td><select data-bind="options: $root.categories, value: todoItem.todoCtg, optionsText:'ctgName'"></select></td>
					<td><input data-bind="value: todoItem.todoDate"/></td>
					<td><a href="#" data-bind="click: $root.removeTodoItem">Remove</a></td>
				</tr>
			</tbody>
		</table>
		<button data-bind='click: addTodoItem'>Add Item</button>
	</form>
	<br><br><br><br>
	<h2>Prioritized List</h2>
	<ul data-bind="foreach:{data:prioritizedList, as: 'ptd'}">
		<li>
			<span data-bind="text: $data"></span>
		</li>
	</ul>

	<br><br><br><br>
	<pre data-bind="text:ko.toJSON($root, null, 2)"></pre>

	<!-- <h2>Prioritized Schedule</h2>
	<ul data-bind="foreach: {data:prioritizedList, as:'ptd'}">
		<li>
			<div>
				<span data-bind="text: ptd.pname"></span>
			</div>
		</li>
	</ul> -->

	<!-- import javascript for the program -->
	<script type="text/javascript" src="projectjs.js"></script>

	<script type="text/javascript">
	$(function(){

		var keywords =[
		{"word":"project", "importance":3, "timesink":5},
		{"word":"meeting", "importance":4, "timesink":0},
		{"word":"test", "importance":5, "timesink":3},
		{"word":"exam", "importance":5, "timesink":3},
		{"word":"quiz", "importance":2, "timesink":1},
		{"word":"reading", "importance":1, "timesink":2},
		{"word":"homework", "importance":3, "timesink":3},
		{"word":"hw", "importance":3, "timesink":5},
		{"word":"essay", "importance":4, "timesink":4},
		{"word":"milestone", "importance":4, "timesink":3},
		{"word":"report", "importance":4, "timesink":5},
		{"word":"!", "importance":5, "timesink":0}
		];

		function Category(name, diff){
			var self= this;
			self.ctgName = ko.observable(name);
			self.ctgDifficulty = ko.observable(diff);
		}

		function TodoItem(name, ctg, date){
			var self = this;
			self.todoName = ko.observable(name);
			self.todoCtg = ko.observable(ctg);
			self.todoDate = ko.observable(date);

		}

		
		function CategoryViewModel(keywords){

			var self = this;

			self.difficultyValues = [
			{diffName: "ChooseOne", diff: 0},
			{diffName: "snore..zzz", diff: 1},
			{diffName: "easy stuff", diff: 2},
			{diffName: "yipes! focus now!", diff: 3},
			{diffName: "Gonna be up late :(", diff: 4},
			{diffName: "OH S**T!", diff: 5}
			];

			self.categories = ko.observableArray([
				new Category("Personal Time", self.difficultyValues[0]),
				new Category("Databases", self.difficultyValues[3]),
				new Category("Theory Of Comp", self.difficultyValues[4]),
				new Category("pre-Algebra", self.difficultyValues[1])
				]);


			self.addCategory = function() {
				self.categories.push( new Category("Type category name", self.difficultyValues[0]));
			};

			self.removeCategory = function(ctg) {
				self.categories.remove(ctg);
			};


			self.todoList = ko.observableArray([
				new TodoItem("DB hw", self.categories[0], "MM/DD/YYY"),
				new TodoItem("ToC project", self.categories[0], "MM/DD/YYY")
				]);

			self.removeTodoItem = function(item){
				self.todoList.remove(item);;
			}
			self.addTodoItem = function(){
				self.todoList.push( new TodoItem("New Task", self.categories[0],"MM/DD/YYY" ));
			}
			console.log(self.todoList);
			
			self.prioritizedList = ko.computed(function(){
				var tempTodoList = self.todoList.slice();
				var pList = new Array();
				var tempPList = new Array();
				console.log(tempTodoList);
				for(var i=0; i<tempTodoList.length; i++){
					var obj ={
						name: tempTodoList[i].todoName._latestValue.toLowerCase(),
						//diff: tempTodoList[i].todoCtg._latestValue.ctgDifficulty._latestValue.diff,
						date: tempTodoList[i].todoDate._latestValue
						//ctg: tempTodoList[i].todoCtg._latestValue.ctgName._latestValue
					};
					tempPList.push(obj);
					pList.push(tempTodoList[i].todoName._latestValue);
				}
				console.log(tempPList);


				for(var i=0; i<tempPList.length;i++){
					var string = tempPList[i].name;
					var taskImpCount =0;
					for(var k=0; k<keywords.length; k++){
						var index = string.search(keywords[k].word)
						//console.log(keywords[k].word);
						if(index>=0){
							console.log(keywords[k].word);
						}
					}
				}
				
				return pList;
			})
		}

		ko.applyBindings(new CategoryViewModel(keywords));

	});
</script>

</body>

</html>